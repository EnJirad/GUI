-- Xlib.lua

local Xlib = {}

function Xlib.new()
    local self = setmetatable({}, { __index = Xlib })
    self.MainFrame = Instance.new("Frame")
    self.MainFrame.Name = "XlibMainFrame"
    self.MainFrame.Size = UDim2.new(0, 400, 0, 300)
    self.MainFrame.BackgroundTransparency = 0.5
    self.MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    self.MainFrame.BorderSizePixel = 0
    self.MainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
    self.MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)

    self.TabFrame = Instance.new("Frame")
    self.TabFrame.Name = "XlibTabFrame"
    self.TabFrame.Size = UDim2.new(0.3, 0, 1, 0)
    self.TabFrame.Position = UDim2.new(0, 0, 0, 0)
    self.TabFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    self.TabFrame.BorderSizePixel = 0
    self.TabFrame.Parent = self.MainFrame

    self.ToggleFrame = Instance.new("Frame")
    self.ToggleFrame.Name = "XlibToggleFrame"
    self.ToggleFrame.Size = UDim2.new(0.7, 0, 1, 0)
    self.ToggleFrame.Position = UDim2.new(0.3, 0, 0, 0)
    self.ToggleFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    self.ToggleFrame.BorderSizePixel = 0
    self.ToggleFrame.Parent = self.MainFrame

    self.Toggles = {}

    return self
end

function Xlib:MakeWindow(config)
    local window = {}
    window.Name = config.Name or "Window"
    window.MainFrame = Xlib.MainFrame:Clone()
    window.MainFrame.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    window.MainFrame.Name = window.Name
    return setmetatable(window, { __index = Xlib })
end

function Xlib:MakeTab(config)
    local tab = {}
    tab.Name = config.Name or "Tab"
    tab.Frame = Instance.new("Frame")
    tab.Frame.Name = tab.Name
    tab.Frame.Size = UDim2.new(1, 0, 1, 0)
    tab.Frame.BackgroundTransparency = 1
    tab.Frame.Parent = self.TabFrame

    tab.ToggleButtons = {}

    local function activateTab()
        for _, t in pairs(self.TabFrame:GetChildren()) do
            if t:IsA("TextButton") then
                t.BackgroundTransparency = 0.5
            end
        end
        tab.Frame.Visible = true
    end

    local TabButton = Instance.new("TextButton")
    TabButton.Name = tab.Name
    TabButton.Size = UDim2.new(1, 0, 0, 50)
    TabButton.Position = UDim2.new(0, 0, 0, #self.TabFrame:GetChildren() * 50)
    TabButton.BackgroundColor3 = Color3.new(1, 1, 1)
    TabButton.BackgroundTransparency = 0.5
    TabButton.TextColor3 = Color3.new(0, 0, 0)
    TabButton.Text = tab.Name
    TabButton.FontSize = Enum.FontSize.Size14
    TabButton.TextStrokeTransparency = 0.75
    TabButton.BorderSizePixel = 0
    TabButton.AutoButtonColor = false
    TabButton.Parent = self.TabFrame

    TabButton.MouseButton1Click:Connect(function()
        activateTab()
    end)

    tab.Activate = activateTab

    return setmetatable(tab, { __index = self })
end

function Xlib:MakeToggle(config)
    local toggle = {}
    toggle.Name = config.Name or "Toggle"
    toggle.Frame = Instance.new("Frame")
    toggle.Frame.Name = toggle.Name
    toggle.Frame.Size = UDim2.new(1, 0, 0, 30)
    toggle.Frame.BackgroundTransparency = 1
    toggle.Frame.Parent = self.ToggleFrame

    toggle.Checkmark = Instance.new("ImageLabel")
    toggle.Checkmark.Name = "Checkmark"
    toggle.Checkmark.Size = UDim2.new(0, 24, 0, 24)
    toggle.Checkmark.Position = UDim2.new(0, 3, 0.5, -12)
    toggle.Checkmark.Image = "http://www.roblox.com/asset/?id=6087584876"  -- Replace with your checkmark image
    toggle.Checkmark.BackgroundTransparency = 1
    toggle.Checkmark.Parent = toggle.Frame

    toggle.Label = Instance.new("TextLabel")
    toggle.Label.Name = "Label"
    toggle.Label.Size = UDim2.new(1, -30, 1, 0)
    toggle.Label.Position = UDim2.new(0, 30, 0, 0)
    toggle.Label.Text = toggle.Name
    toggle.Label.TextColor3 = Color3.new(1, 1, 1)
    toggle.Label.TextStrokeTransparency = 0.75
    toggle.Label.TextXAlignment = Enum.TextXAlignment.Left
    toggle.Label.FontSize = Enum.FontSize.Size14
    toggle.Label.BackgroundTransparency = 1
    toggle.Label.Parent = toggle.Frame

    toggle.ToggleButton = Instance.new("TextButton")
    toggle.ToggleButton.Name = "ToggleButton"
    toggle.ToggleButton.Size = UDim2.new(0, 30, 1, 0)
    toggle.ToggleButton.Position = UDim2.new(1, -30, 0, 0)
    toggle.ToggleButton.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    toggle.ToggleButton.Text = ""
    toggle.ToggleButton.BorderSizePixel = 0
    toggle.ToggleButton.Parent = toggle.Frame

    local function updateToggle()
        toggle.Checkmark.Visible = not toggle.Checkmark.Visible
        config.Callback(toggle.Checkmark.Visible)
    end

    toggle.ToggleButton.MouseButton1Click:Connect(function()
        updateToggle()
    end)

    toggle.ToggleButton.MouseEnter:Connect(function()
        toggle.ToggleButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    end)

    toggle.ToggleButton.MouseLeave:Connect(function()
        toggle.ToggleButton.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    end)

    toggle.Update = function(state)
        toggle.Checkmark.Visible = state
        config.Callback(state)
    end

    table.insert(self.Toggles, toggle)

    return toggle
end

return Xlib
