local Xlib = {}

function Xlib:MakeWindow(properties)
    local window = Instance.new("ScreenGui")
    window.Name = properties.Name or "Window"
    window.Parent = properties.Parent or game.Players.LocalPlayer:WaitForChild("PlayerGui")
    window.ResetOnSpawn = false

    local mainFrame = Instance.new("Frame", window)
    mainFrame.Size = properties.Size or UDim2.new(0, 400, 0, 350)
    mainFrame.Position = properties.Position or UDim2.new(0.5, -200, 0.5, -175)
    mainFrame.BackgroundColor3 = properties.BackgroundColor3 or Color3.fromRGB(40, 40, 40)
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true

    local titleBar = Instance.new("Frame", mainFrame)
    titleBar.Size = UDim2.new(1, 0, 0, 30)
    titleBar.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    titleBar.Active = true
    titleBar.Draggable = true

    local titleLabel = Instance.new("TextLabel", titleBar)
    titleLabel.Size = UDim2.new(1, -90, 1, 0)
    titleLabel.Position = UDim2.new(0, 10, 0, 0)
    titleLabel.Text = properties.Name or "Window"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Font = Enum.Font.SourceSansBold
    titleLabel.TextSize = 18

    local minimizeButton = Instance.new("TextButton", titleBar)
    minimizeButton.Size = UDim2.new(0, 30, 0, 30)
    minimizeButton.Position = UDim2.new(1, -70, 0, 0)
    minimizeButton.Text = "_"
    minimizeButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.Font = Enum.Font.SourceSansBold
    minimizeButton.TextSize = 20

    local closeButton = Instance.new("TextButton", titleBar)
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -40, 0, 0)
    closeButton.Text = "X"
    closeButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.Font = Enum.Font.SourceSansBold
    closeButton.TextSize = 20

    local tabContainer = Instance.new("Frame", mainFrame)
    tabContainer.Size = UDim2.new(0, 120, 1, -30)
    tabContainer.Position = UDim2.new(0, 0, 0, 30)
    tabContainer.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

    local contentFrame = Instance.new("Frame", mainFrame)
    contentFrame.Size = UDim2.new(1, -120, 1, -30)
    contentFrame.Position = UDim2.new(0, 120, 0, 30)
    contentFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    contentFrame.Visible = true

    local minimizedIcon = Instance.new("Frame", window)
    minimizedIcon.Size = UDim2.new(0, 60, 0, 60)
    minimizedIcon.Position = UDim2.new(0, 10, 0, 10)
    minimizedIcon.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    minimizedIcon.Visible = false
    minimizedIcon.Active = true
    minimizedIcon.Draggable = true

    local iconLabel = Instance.new("TextLabel", minimizedIcon)
    iconLabel.Size = UDim2.new(1, 0, 1, 0)
    iconLabel.Text = properties.Name or "Icon"
    iconLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    iconLabel.BackgroundTransparency = 1
    iconLabel.Font = Enum.Font.SourceSansBold
    iconLabel.TextSize = 14

    minimizeButton.MouseButton1Click:Connect(function()
        mainFrame.Visible = false
        minimizedIcon.Visible = true
    end)

    minimizedIcon.MouseButton1Click:Connect(function()
        mainFrame.Visible = true
        minimizedIcon.Visible = false
    end)

    closeButton.MouseButton1Click:Connect(function()
        window:Destroy()
    end)

    local tabs = {}
    local currentTab

    local function switchTab(tab)
        if currentTab then
            currentTab.frame.Visible = false
        end
        tab.frame.Visible = true
        currentTab = tab
    end

    function tabs:MakeTab(properties)
        local tabButton = Instance.new("TextButton", tabContainer)
        tabButton.Size = UDim2.new(1, 0, 0, 30)
        tabButton.Position = UDim2.new(0, 0, 0, (#tabContainer:GetChildren() - 1) * 30)
        tabButton.Text = properties.Name or "Tab"
        tabButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        tabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        tabButton.Font = Enum.Font.SourceSansBold
        tabButton.TextSize = 16
        tabButton.MouseButton1Click:Connect(function()
            switchTab(properties)
        end)

        local tabFrame = Instance.new("Frame", contentFrame)
        tabFrame.Size = UDim2.new(1, 0, 1, 0)
        tabFrame.Position = UDim2.new(0, 0, 0, 0)
        tabFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        tabFrame.Visible = false

        local tab = {
            button = tabButton,
            frame = tabFrame,
            toggles = {}
        }

        function tab:AddToggle(toggleProperties)
            local toggleFrame = Instance.new("Frame", tabFrame)
            toggleFrame.Size = UDim2.new(1, -10, 0, 30)
            toggleFrame.Position = UDim2.new(0, 5, 0, (#tabFrame:GetChildren() - 1) * 35)
            toggleFrame.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
            toggleFrame.BorderSizePixel = 0

            local toggleButton = Instance.new("TextButton", toggleFrame)
            toggleButton.Size = UDim2.new(1, 0, 1, 0)
            toggleButton.Text = toggleProperties.Name or "Toggle"
            toggleButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
            toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            toggleButton.Font = Enum.Font.SourceSansBold
            toggleButton.TextSize = 16
            toggleButton.TextXAlignment = Enum.TextXAlignment.Left

            local checkMark = Instance.new("TextLabel", toggleButton)
            checkMark.Size = UDim2.new(0, 30, 1, 0)
            checkMark.Position = UDim2.new(1, -30, 0, 0)
            checkMark.Text = "âœ“"
            checkMark.TextColor3 = Color3.fromRGB(255, 255, 255)
            checkMark.BackgroundTransparency = 1
            checkMark.Font = Enum.Font.SourceSansBold
            checkMark.TextSize = 20
            checkMark.Visible = toggleProperties.Default

            toggleButton.MouseButton1Click:Connect(function()
                toggleProperties.Callback(not toggleProperties.Default)
                checkMark.Visible = not toggleProperties.Default
                toggleProperties.Default = not toggleProperties.Default
            end)

            table.insert(tab.toggles, toggleFrame)
        end

        table.insert(tabs, tab)
        switchTab(tab)
        return tab
    end

    return tabs
end

return Xlib
